<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Blockchain Introduction/smart-contract-intro">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.1">
<title data-rh="true">What Is a Smart Contract | Multiversity</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://multiversity.wefuzz.io//blockchain/smart-contract-intro"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="What Is a Smart Contract | Multiversity"><meta data-rh="true" name="description" content="Introduction to Smart Contracts"><meta data-rh="true" property="og:description" content="Introduction to Smart Contracts"><link data-rh="true" rel="icon" href="/img/multiversityx1.png"><link data-rh="true" rel="canonical" href="https://multiversity.wefuzz.io//blockchain/smart-contract-intro"><link data-rh="true" rel="alternate" href="https://multiversity.wefuzz.io//blockchain/smart-contract-intro" hreflang="en"><link data-rh="true" rel="alternate" href="https://multiversity.wefuzz.io//blockchain/smart-contract-intro" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.69640c8f.css">
<link rel="preload" href="/assets/js/runtime~main.837c66bb.js" as="script">
<link rel="preload" href="/assets/js/main.ac57620b.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/multiversityx1.png" alt="&lt;multiversity&gt;" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/multiversityx1.png" alt="&lt;multiversity&gt;" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Multiversity</b></a></div><div class="navbar__items navbar__items--right"><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">👾 WeFuzz Multiversity</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/contributors">Contributors 👬👭</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/blockchain">Blockchain ⛓️</a><button aria-label="Toggle the collapsible sidebar category &#x27;Blockchain ⛓️&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blockchain/day-1-toc">ToC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blockchain/introduction">What is Blockchain?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blockchain/cryptography">Cryptography, Keys and Wallets</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/blockchain/smart-contract-intro">What Is a Smart Contract</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blockchain/ethereum-intro">Introduction to Ethereum</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blockchain/solana-intro">Introduction to Solana</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/smart-contracts">Smart Contracts</a><button aria-label="Toggle the collapsible sidebar category &#x27;Smart Contracts&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/vulnerabilities-and-exploits">Vulnerabilities and Exploits 💣</a><button aria-label="Toggle the collapsible sidebar category &#x27;Vulnerabilities and Exploits 💣&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/post-mortem-reports">Post-mortem Reports</a><button aria-label="Toggle the collapsible sidebar category &#x27;Post-mortem Reports&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/tools">Tools 🛠️</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tools 🛠️&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/writeups">Writeups 📝</a><button aria-label="Toggle the collapsible sidebar category &#x27;Writeups 📝&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Books">📚 Books</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/sources">ℹ️ Sources</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction-to-smart-contracts">Introduction to Smart Contracts<a class="hash-link" href="#introduction-to-smart-contracts" title="Direct link to heading">​</a></h2><p>Smart contracts are programs that run on top of a blockchain and encapsulate the terms of a contract to be executed when certain conditions are met. Smart contracts were first theorized by <code>Nick Szabo</code> in the
late 1990s.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Code is Law</div><div class="admonitionContent_S0QG"><p>Unlike regular Legal agreements, which require a trusted third party to mediate disputes and enforce the agreements, a Smart contract is self-enforcing. Legal contracts are open to interpretation. Smart contracts are written in code and interpreted and executed by machines.</p></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Smart Contract</div><div class="admonitionContent_S0QG"><p>A smart contract is a computerized transaction protocol that executes the terms of a contract. The general objectives of smart contract design are to satisfy common contractual conditions (such as payment terms, liens, confidentiality, and even enforcement), minimize exceptions both malicious and accidental, and minimize the need for trusted intermediaries. Related economic goals include lowering fraud loss, arbitration and enforcement costs, and other transaction costs.</p><p>...</p><p>Digital cash protocols are fine examples of smart contracts. They enable online payment while honoring the characteristics desired of paper cash: unforgeability, confidentiality, and divisibility.</p></div></div><p>Vending machines or ticket machines in a railway station can be treated as a simple example of a digitized contract. With the right inputs, a specific output is guaranteed.</p><ul><li>You select a product</li><li>The machine returns the amount required to purchase the product</li><li>You insert the required amount with the supported currency</li><li>The vending machine verifies you have inserted enough currency</li><li>The vending machine dispenses the product of choice</li></ul><p>Smart contracts are inherently required to be deterministic. That is, it should be possible for any node on a network to run the smart contract with the same inputs and achieve the same result. The nodes should reach a consensus on these results.</p><p>So, essentially Smart Contracts are software that make use of blockchain technology to codify business logic and self-execute an agreement based on conditions they automatically detect.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="oracles"><em>Oracles</em><a class="hash-link" href="#oracles" title="Direct link to heading">​</a></h2><p>Smart contracts stay inside the blockchain, i.e., they cannot access external data, which might be required to execute some contract terms. An oracle is a bridge between the blockchain and the real world. An example is the security&#x27;s stock price that the contract needs to release the dividend payments.</p><p>There are mainly two categories of Oracles:</p><ul><li>Standard or Simple Oracle: A centralized, reputable organization provides the off-chain data</li><li>Decentralized Oracle: A decentralized way of receiving the off-chain data</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="smart-contract-use-cases-and-platforms">Smart Contract Use Cases and Platforms<a class="hash-link" href="#smart-contract-use-cases-and-platforms" title="Direct link to heading">​</a></h2><p>Applications of Smart Contracts range from finance, e-commerce, supply-chain, gaming, insurance, auditing, and taxation. One of the use-cases of Smart Contracts that the market is using vastly is Programmable Money, i.e., the conditions to transfer the money will be codified by the developers in the Smart Contracts. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="financial-security"><em>Financial Security</em><a class="hash-link" href="#financial-security" title="Direct link to heading">​</a></h3><p>Smart contracts could be used for liability management, automatic payments, stock splits, and dividends.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="digital-identity"><em>Digital Identity</em><a class="hash-link" href="#digital-identity" title="Direct link to heading">​</a></h3><p>Smart contracts provide individual identity in digital assets, remove counterfeits and also make KYC frictionless.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="trade-finance"><em>Trade Finance</em><a class="hash-link" href="#trade-finance" title="Direct link to heading">​</a></h3><p>Smart contracts could be used for cross-border payments and international trade without the intervention of Banks and governments.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="financial-data-recording"><em>Financial Data Recording</em><a class="hash-link" href="#financial-data-recording" title="Direct link to heading">​</a></h3><p>Smart contracts improve data recording and accuracy and save reporting and auditing costs using the blockchain as the database.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="supply-chain-management"><em>Supply Chain Management</em><a class="hash-link" href="#supply-chain-management" title="Direct link to heading">​</a></h3><p>Smart contracts could be used to automate supply chain management with visibility and transparency, leading to fewer frauds.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="government"><em>Government</em><a class="hash-link" href="#government" title="Direct link to heading">​</a></h3><p>Smart contracts could be used for elections, voting on policy proposals, and voting on passing new bills. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="insurance"><em>Insurance</em><a class="hash-link" href="#insurance" title="Direct link to heading">​</a></h3><p>Smart contracts could be used to automate claims and resolves disputes with proof.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="loyalty-points"><em>Loyalty Points</em><a class="hash-link" href="#loyalty-points" title="Direct link to heading">​</a></h3><p>Smart contracts and Programmable money can be used by organizations to reward their customers.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="escrow"><em>Escrow</em><a class="hash-link" href="#escrow" title="Direct link to heading">​</a></h3><p>Smart contracts are the perfect resource for implementing escrow accounts with Programmable money.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="dao"><em>DAO</em><a class="hash-link" href="#dao" title="Direct link to heading">​</a></h3><p>DAO stands for Decentralised Autonomous Organizations. Smart contracts lay the foundational rules and execute the agreed-upon decisions making DAO a fully autonomous and transparent entity. At any point, the community can review publicly audit proposals, voting, and even the code itself.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="a-brief-history-of-smart-contracts-hacks">A brief history of Smart Contracts Hacks<a class="hash-link" href="#a-brief-history-of-smart-contracts-hacks" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="dao-hack">DAO Hack<a class="hash-link" href="#dao-hack" title="Direct link to heading">​</a></h3><p>Members of the Ethereum community, at the beginning of May 2016, announced the inception of The DAO, which was also known as Genesis DAO. The DAO was meant to operate like a venture capital fund for the crypto and decentralized space. </p><p>The DAO has raised 12.7M Ether in the creation period ($150M at the time of creation, and approx $22 Billion in 2022). This is the biggest crowdfund ever. </p><p>The idea of the DAO is members could pitch their idea to the community and potentially receive funding from the DAO.  Anyone with DAO tokens could vote on plans and would then receive rewards if the projects turned a profit. The DAO&#x27;s business logic was built as a smart contract on the Ethereum blockchain.</p><p>However, on June 17, 2016, a hacker found a loophole in the coding that allowed him to drain funds from The DAO.</p><div class="theme-admonition theme-admonition-danger alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>Hack</div><div class="admonitionContent_S0QG"><p>In computing, a computer program or subroutine is called reentrant if multiple invocations can safely run concurrently on multiple processors, or on a single processor system. A <code>re-entrancy attack</code> occurs when a function makes an external call to another untrusted contract and the untrusted contract makes a recursive call back to the original function in an attempt to drain funds.</p></div></div><p><img loading="lazy" alt="DAO Expected Flow" src="/assets/images/dao-expected-459bf7187fa1a7ef52d0559308df773e.jpg" width="5310" height="3012" class="img_ev3q"></p><div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">splitDAO</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token builtin" style="color:rgb(189, 147, 249)">uint</span><span class="token plain"> _proposalID</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">address</span><span class="token plain"> _newCurator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> noEther onlyTokenholders </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token builtin" style="color:rgb(189, 147, 249)">bool</span><span class="token plain"> _success</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// Move ether and assign new Tokens</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token builtin" style="color:rgb(189, 147, 249)">uint</span><span class="token plain"> fundsToBeMoved </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">balances</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sender</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"> p</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">splitData</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">splitBalance</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">/</span><span class="token plain"> p</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">splitData</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">totalSupply</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)">// @@@note: notice how this is done first!</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">p</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">splitData</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">newDAO</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">createTokenProxy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">fundsToBeMoved</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sender</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">==</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// @@@note: This is the line the attacker wants to  run more than once</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">      </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">throw</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span></span></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// Burn DAO Tokens</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">Transfer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sender</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> balances</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sender</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">withdrawRewardFor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sender</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain">                      </span><span class="token comment" style="color:rgb(98, 114, 164)">// @@@note: withdrawRewardFor -&gt; payOut-&gt; _recipient.call.value: re-entrancy vulnerability</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    balances</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sender</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain">                           </span><span class="token comment" style="color:rgb(98, 114, 164)">// @@@note: Update the sender&#x27;s balance after transferring funds to the user</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    paidOut</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sender</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></span></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">withdrawRewardFor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token builtin" style="color:rgb(189, 147, 249)">address</span><span class="token plain"> _account</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> noEther </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">internal</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token builtin" style="color:rgb(189, 147, 249)">bool</span><span class="token plain"> _success</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token builtin" style="color:rgb(189, 147, 249)">uint</span><span class="token plain"> reward </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">calculateReward</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    rewardAccount</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">payOut</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">_account</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> reward</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></span></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">payOut</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token builtin" style="color:rgb(189, 147, 249)">address</span><span class="token plain"> _recipient</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">uint</span><span class="token plain"> _amount</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token builtin" style="color:rgb(189, 147, 249)">bool</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    _recipient</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">call</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">_amount</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#F8F8F2"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></span></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="DAO Hack" src="/assets/images/dao-hack-c22f5def5435ae23049516b38589fa8d.jpg" width="5773" height="2771" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="impact-of-the-hack">Impact of the hack<a class="hash-link" href="#impact-of-the-hack" title="Direct link to heading">​</a></h4><p>To reverse the effects of the hack, the Ethereum community decided to go through a <strong>hard fork</strong>.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Fork</div><div class="admonitionContent_S0QG"><ul><li><strong>Soft fork</strong>: A soft fork is a software update of a blockchain network that is backward compatible.</li><li><strong>Hard fork</strong>: A hard fork is a software update that is not backwards compatible. Might lead to network split.</li></ul></div></div><p>The hard fork effectively rolled back the Ethereum network&#x27;s history to before <strong>The DAO attack</strong> and reallocated The DAO&#x27;s <em>ether</em> (ETH) to a different smart contract so that investors could withdraw their funds. </p><p>This is extremely controversial — after all, blockchains are supposed to be <strong>immutable</strong> and <strong>censorship-resistant</strong>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="parity-wallet-hack">Parity Wallet Hack<a class="hash-link" href="#parity-wallet-hack" title="Direct link to heading">​</a></h3><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Multisig</div><div class="admonitionContent_S0QG"><p>Multi-signature (Multisig) wallet requires multiple keys to <strong>authorize</strong> a transaction, rather than a <strong>single</strong> signature from one key. Usually, Multisig Wallets are implemented as a Smart Contract.</p></div></div><p><img loading="lazy" alt="multisig" src="/assets/images/multisig-47fc846332eedc1d7341a236da881b28.jpg" width="5202" height="3075" class="img_ev3q">
Parity technologies is a key infrastructure developer company in Ethereum. Parity Technologies made  multisig smart contract wallets open-source and available for everyone to deploy and use.</p><p>In 2017, a black-hat hacker used a vulnerability to drain the Parity wallets of three Ethereum projects,  Swarm City, Edgeless, Aeternity, stealing a combined 153,037 ETH. These wallets were used to store funds from past token sales.</p><p>The bug, specific to the multi-signature contract known as wallet.sol, allowed the hacker to take ownership of a victim’s wallet with a single transaction.</p><p>The attacker sent two transactions each to the affected contracts:</p><ul><li>the <a href="https://etherscan.io/tx/0x9dbf0326a03a2a3719c27be4fa69aacc9857fd231a8d9dcaede4bb083def75ec" target="_blank" rel="noopener noreferrer">first</a> to obtain exclusive ownership of the multisig.</li><li>the <a href="https://etherscan.io/tx/0xeef10fc5170f669b86c4cd0444882a96087221325f8bf2f55d6188633aa7be7c" target="_blank" rel="noopener noreferrer">second</a> to move all of its funds.</li></ul><p>We can see that the first transaction calls initWallet function with 3 arguments setting the attacker&#x27;s public key <a href="https://etherscan.io/address/0xB3764761E297D6f121e79C32A65829Cd1dDb4D32" target="_blank" rel="noopener noreferrer">0xB3764761E297D6f121e79C32A65829Cd1dDb4D32</a> as the owner of the contract.</p><p><img loading="lazy" alt="parity initWallet transaction" src="/assets/images/parity-tx-1-2a0fd2701ad7c30374a609f5860263b4.png" width="976" height="912" class="img_ev3q"></p><p>Snippet of <a href="https://github.com/openethereum/parity-ethereum/blob/4d08e7b0aec46443bf26547b17d10cb302672835/js/src/contracts/snippets/enhanced-wallet.sol#L216" target="_blank" rel="noopener noreferrer">initWallet</a> method from <code>WalletLibrary</code> contract:</p><p><img loading="lazy" alt="parity initWallet method" src="/assets/images/parity-hack1-52fabdcae4e9dfafcf1d0badeed9ec3c.svg" width="1572" height="536" class="img_ev3q"></p><p>The <code>initWallet</code> method seems to be a converted constructor method to make the WalletLibrary contract a separate library contract so once deployed. This pattern is referred to as the Proxy pattern, explained in detail <a href="https://blog.openzeppelin.com/proxy-libraries-in-solidity-79fbe4b970fd/" target="_blank" rel="noopener noreferrer">here</a>.</p><p>The proxy contracts usually just forwards all unmatched function calls to the contract behind the proxy, using <a href="https://docs.soliditylang.org/en/v0.8.16/introduction-to-smart-contracts.html?highlight=delegatecall#delegatecall-callcode-and-libraries" target="_blank" rel="noopener noreferrer">deletegateCall</a>. This can be seen in the <a href="https://github.com/openethereum/parity-ethereum/blob/4d08e7b0aec46443bf26547b17d10cb302672835/js/src/contracts/snippets/enhanced-wallet.sol#L424" target="_blank" rel="noopener noreferrer">payable</a> method.</p><p><img loading="lazy" alt="parity Payable method" src="/assets/images/parity-hack2-d4ea4d0568ceb324569945fce35cff5c.svg" width="1150" height="610" class="img_ev3q"></p><div class="theme-admonition theme-admonition-danger alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>HACK</div><div class="admonitionContent_S0QG"><p>This allowed anyone to call all the public functions from the WalletLibrary, including <code>initWallet</code>, which can change the contract&#x27;s owners.</p></div></div><p>Using this pattern, attacker managed to make his wallet&#x27;s address as the owner of the WalletLibrary contract and managed to withdraw all the funds by calling <a href="https://github.com/openethereum/parity-ethereum/blob/4d08e7b0aec46443bf26547b17d10cb302672835/js/src/contracts/snippets/enhanced-wallet.sol#L230" target="_blank" rel="noopener noreferrer">execute</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-nomad-bridge-hack">The Nomad Bridge Hack<a class="hash-link" href="#the-nomad-bridge-hack" title="Direct link to heading">​</a></h3><p>Feb, 2022, a hacker exploited a vulnerability in Wormhole&#x27;s smart contract code that allowed the hacker to mint 120,000 Wrapped Ether (WeETH) on Solana blockchain.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Wormhole</div><div class="admonitionContent_S0QG"><p>Wormhole is a communication bridge between Solana and other top decentralized finance (DeFi) networks. Existing projects, platforms, and communities are able to move tokenized assets seamlessly across blockchains and benefit from Solana’s high speed and low cost.</p></div></div><p>A Bridge is a link between two blockchains, basically a way to move crypto assets (tokens, NFTs) between different blockchains.</p><p>The way these protocols work:</p><ul><li>A user interacts with cross-chain bridge by sending funds in one asset to the bridge protocol (asset-origin)</li><li>these funds are locked into the contract  (asset-locked)</li><li>The user is issued a equivalent funds of an asset on the chain the asset was sent to. (asset-mint)</li></ul><p><img loading="lazy" src="https://solana.ghost.io/content/images/downloaded_images/Wormhole---Solana-Ethereum-Bridge/0-anrVzrb4gyCAFtqt.png" alt="Ethereum Solana Bridge" class="img_ev3q"></p><div class="theme-admonition theme-admonition-danger alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>hack</div><div class="admonitionContent_S0QG"><p>An implementation bug caused the <code>Replica</code> contract to fail to authenticate messages properly. This issue allowed any message to be forged as long as it had not already been processed. As a result, contracts relying on the <code>Replica</code> for authentication of inbound messages suffered security failures. This authentication failure resulted in fraudulent messages being passed to the Nomad <code>BridgeRouter</code> contract.</p></div></div><p><img loading="lazy" alt="initialize method" src="/assets/images/nomad-initialize-999eca0b646b727c8633b32e179b6ab7.png" width="1202" height="870" class="img_ev3q"></p><p><img loading="lazy" alt="Replica contract" src="/assets/images/nomad-replica-contract-9e0859db1112caf8679ba881f25398b8.png" width="1572" height="758" class="img_ev3q"></p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>@samczsun</div><div class="admonitionContent_S0QG"><p>“... <!-- -->[Y]<!-- -->ou didn&#x27;t need to know about Solidity or Merkle Trees or anything like that. All you had to do was find a transaction that worked, find/replace the other person&#x27;s address with yours, and then re-broadcast it,” @samczsun explained.</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="ronin-network-bridge-hack">Ronin Network Bridge Hack<a class="hash-link" href="#ronin-network-bridge-hack" title="Direct link to heading">​</a></h3><p>The Ronin Network hack was a result of compromised private keys of the validators. Ronin Network uses a set of 9 validator nodes to approve transactions on the bridge. A deposit/withdrawal requires approval by a majority of 5 out of 9 nodes. </p><div class="theme-admonition theme-admonition-danger alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>HACK</div><div class="admonitionContent_S0QG"><p>The attacker gained control of 4 validators controlled by Sky Mavis and a third-party Axie DAO validator, totalling 5 validators, that signed their malicious transactions.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="references">References<a class="hash-link" href="#references" title="Direct link to heading">​</a></h2><ul><li><a href="https://www.fon.hum.uva.nl/rob/Courses/InformationInSpeech/CDROM/Literature/LOTwinterschool2006/szabo.best.vwh.net/smart.contracts.html" target="_blank" rel="noopener noreferrer">Smart Contracts - by Nick Szabo</a></li><li><a href="https://lawofthelevel.lexblogplatformthree.com/wp-content/uploads/sites/187/2017/07/WhitePaper-1.pdf" target="_blank" rel="noopener noreferrer">&quot;DECENTRALIZED AUTONOMOUS ORGANIZATION TO AUTOMATE GOVERNANCE&quot;</a></li><li><a href="https://firstmonday.org/ojs/index.php/fm/article/view/548" target="_blank" rel="noopener noreferrer">Formalizing and Securing Relationships on Public Networks</a></li><li><a href="https://ethereum.org/en/developers/docs/oracles/" target="_blank" rel="noopener noreferrer">Oracles</a></li><li><a href="https://github.com/pcaversaccio/reentrancy-attacks" target="_blank" rel="noopener noreferrer">A chronological and (hopefully) complete list of reentrancy attacks to date</a></li><li><a href="https://hackingdistributed.com/2016/06/18/analysis-of-the-dao-exploit/" target="_blank" rel="noopener noreferrer">Analysis of the DAO exploit</a></li><li><a href="https://www.parity.io/blog/the-multi-sig-hack-a-postmortem" target="_blank" rel="noopener noreferrer">Parity Hack</a></li><li>[Wormhole]<a href="https://solana.com/news/wormhole---solana-ethereum-bridge" target="_blank" rel="noopener noreferrer">https://solana.com/news/wormhole---solana-ethereum-bridge</a></li><li><a href="https://extropy-io.medium.com/solanas-wormhole-hack-post-mortem-analysis-3b68b9e88e13" target="_blank" rel="noopener noreferrer">Wormhole bridge hack</a></li><li><a href="https://roninblockchain.substack.com/p/community-alert-ronin-validators?s=w" target="_blank" rel="noopener noreferrer">Ronin Network Hack</a></li><li><a href="https://medium.com/nomad-xyz-blog/nomad-bridge-hack-root-cause-analysis-875ad2e5aacd" target="_blank" rel="noopener noreferrer">Nomand Bridge Hack: Root Cause Analysis</a></li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blockchain/cryptography"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Cryptography, Keys and Wallets</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blockchain/ethereum-intro"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Introduction to Ethereum</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction-to-smart-contracts" class="table-of-contents__link toc-highlight">Introduction to Smart Contracts</a></li><li><a href="#oracles" class="table-of-contents__link toc-highlight"><em>Oracles</em></a></li><li><a href="#smart-contract-use-cases-and-platforms" class="table-of-contents__link toc-highlight">Smart Contract Use Cases and Platforms</a><ul><li><a href="#financial-security" class="table-of-contents__link toc-highlight"><em>Financial Security</em></a></li><li><a href="#digital-identity" class="table-of-contents__link toc-highlight"><em>Digital Identity</em></a></li><li><a href="#trade-finance" class="table-of-contents__link toc-highlight"><em>Trade Finance</em></a></li><li><a href="#financial-data-recording" class="table-of-contents__link toc-highlight"><em>Financial Data Recording</em></a></li><li><a href="#supply-chain-management" class="table-of-contents__link toc-highlight"><em>Supply Chain Management</em></a></li><li><a href="#government" class="table-of-contents__link toc-highlight"><em>Government</em></a></li><li><a href="#insurance" class="table-of-contents__link toc-highlight"><em>Insurance</em></a></li><li><a href="#loyalty-points" class="table-of-contents__link toc-highlight"><em>Loyalty Points</em></a></li><li><a href="#escrow" class="table-of-contents__link toc-highlight"><em>Escrow</em></a></li><li><a href="#dao" class="table-of-contents__link toc-highlight"><em>DAO</em></a></li></ul></li><li><a href="#a-brief-history-of-smart-contracts-hacks" class="table-of-contents__link toc-highlight">A brief history of Smart Contracts Hacks</a><ul><li><a href="#dao-hack" class="table-of-contents__link toc-highlight">DAO Hack</a></li><li><a href="#parity-wallet-hack" class="table-of-contents__link toc-highlight">Parity Wallet Hack</a></li><li><a href="#the-nomad-bridge-hack" class="table-of-contents__link toc-highlight">The Nomad Bridge Hack</a></li><li><a href="#ronin-network-bridge-hack" class="table-of-contents__link toc-highlight">Ronin Network Bridge Hack</a></li></ul></li><li><a href="#references" class="table-of-contents__link toc-highlight">References</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.837c66bb.js"></script>
<script src="/assets/js/main.ac57620b.js"></script>
</body>
</html>